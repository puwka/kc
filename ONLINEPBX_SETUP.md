# Настройка интеграции с OnlinePBX

## 1. Получение API ключей

1. Войдите в панель управления OnlinePBX
2. Перейдите в раздел "API" или "Интеграции"
3. Создайте новый API ключ
4. Запишите полученные данные

## 2. Настройка переменных окружения

Добавьте в файл `.env` следующие переменные:

```env
# OnlinePBX Configuration
ONLINEPBX_API_URL=https://onlinepbx.evateam.ru/api
ONLINEPBX_API_KEY=your_api_key_here
ONLINEPBX_DOMAIN=your_domain_here
ONLINEPBX_CALLER_ID=your_caller_id_here
ONLINEPBX_OPERATOR_NUMBER=your_operator_number_here
```

## 3. Настройка базы данных

Выполните SQL скрипт для создания таблиц телефонии:

```sql
-- Выполните содержимое файла database/telephony-system.sql
```

## 4. Настройка callback URL

В настройках OnlinePBX укажите callback URL:
```
https://your-domain.com/api/telephony/callback
```

## 5. Тестирование

1. Запустите сервер: `npm start`
2. Откройте главную страницу
3. Нажмите кнопку "Звонить"
4. Проверьте, что звонок инициируется

## 6. Мониторинг

Проверьте логи сервера для отладки:
- Инициализация звонков
- Статусы звонков
- Callback уведомления

## 7. Возможные проблемы

### Звонок не инициируется
- Проверьте API ключи
- Проверьте настройки домена
- Проверьте номера телефонов

### Callback не работает
- Проверьте URL callback
- Проверьте доступность сервера
- Проверьте логи сервера

### Звонок не соединяется
- Проверьте настройки оператора
- Проверьте права доступа
- Проверьте статус телефонии

